# Basic ModSecurity configuration
# This will be overridden by the ConfigMap version

SecRuleEngine On
SecRequestBodyAccess On
SecResponseBodyAccess On
SecDataDir /tmp/modsecurity/data
SecTmpDir /tmp/modsecurity/tmp
SecAuditLog /var/log/modsec/modsec_audit.log
SecAuditLogFormat JSON
SecAuditLogType Serial
SecDebugLog /var/log/modsec/modsec_debug.log
SecDebugLogLevel 3

# Basic rules
SecRule REQUEST_URI "@contains /admin" "id:1001,phase:1,t:lowercase,deny,status:403,msg:'Access to admin panel blocked'"
SecRule ARGS "@detectSQLi" "id:1002,phase:2,t:lowercase,t:urlDecodeUni,deny,status:403,msg:'SQL Injection detected'"
SecRule ARGS "@detectXSS" "id:1003,phase:2,t:lowercase,t:urlDecodeUni,deny,status:403,msg:'XSS detected'"